---
import site from '@data/site'
import { constructURL, isValidURL, merge } from 'google-fonts-helper'
import { GoogleFontsOptimizer } from 'astro-google-fonts-optimizer'

// // When tailwindconfig supports module, do this to automatically grab the fonts from tailwindconfig
// const { fontFamily, fontWeight } = tailwindconfig.theme
// function getFamilyFromString(string: string): string {
//   return string.split(',')[0].trim().replace(/^['"\s]+|['"\s]+$/g, '')
// }
// // Match font family to font weight
// const familiesObject: FamilyObject = {}
// for (const [key, value] of Object.entries(fontFamily)) {
//   const family = getFamilyFromString(value)
//   if (!familiesObject[family]) {
//     familiesObject[family] = { wght: [] }
//   }
//   const weight = fontWeight?.[key]
//   if (weight) {
//     familiesObject[family].wght?.push(weight)
//   }
// }

const url: string | false = constructURL({ families: site.googleFonts })
const isValid = isValidURL(url.toString())
---

{url && isValid && <GoogleFontsOptimizer url={url} />}
